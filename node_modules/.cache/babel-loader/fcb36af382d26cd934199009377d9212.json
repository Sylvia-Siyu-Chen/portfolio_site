{"ast":null,"code":"'use strict';\n\nmodule.exports = function () {\n  var _this = this;\n\n  if (!this.imagePosition) {\n    this.imagePosition = {\n      x: 0,\n      y: 0,\n      width: 0,\n      height: 0\n    };\n  }\n\n  if (this.image.blendingMode) {\n    this.context.globalCompositeOperation = this.image.blendingMode;\n  }\n\n  if (this.imageNode) {\n    setImagePosition();\n    return;\n  }\n\n  this.imageNode = new Image();\n\n  this.imageNode.onerror = function () {\n    throw new Error('Granim: The image source is invalid.');\n  };\n\n  this.imageNode.onload = function () {\n    _this.imgOriginalWidth = _this.imageNode.width;\n    _this.imgOriginalHeight = _this.imageNode.height;\n    setImagePosition();\n\n    _this.refreshColorsAndPos();\n\n    if (!_this.isPausedWhenNotInView || _this.isCanvasInWindowView) {\n      _this.animation = requestAnimationFrame(_this.animateColors.bind(_this));\n    }\n\n    _this.isImgLoaded = true;\n  };\n\n  this.imageNode.src = this.image.source;\n\n  function setImagePosition() {\n    var i, currentAxis;\n\n    for (i = 0; i < 2; i++) {\n      currentAxis = !i ? 'x' : 'y';\n      setImageAxisPosition(currentAxis);\n    }\n\n    function setImageAxisPosition(axis) {\n      var canvasWidthOrHeight = _this[axis + '1'];\n      var imgOriginalWidthOrHeight = _this[axis === 'x' ? 'imgOriginalWidth' : 'imgOriginalHeight'];\n      var imageAlignIndex = axis === 'x' ? _this.image.position[0] : _this.image.position[1];\n      var imageAxisPosition;\n\n      switch (imageAlignIndex) {\n        case 'center':\n          imageAxisPosition = imgOriginalWidthOrHeight > canvasWidthOrHeight ? -(imgOriginalWidthOrHeight - canvasWidthOrHeight) / 2 : (canvasWidthOrHeight - imgOriginalWidthOrHeight) / 2;\n          _this.imagePosition[axis] = imageAxisPosition;\n          _this.imagePosition[axis === 'x' ? 'width' : 'height'] = imgOriginalWidthOrHeight;\n          break;\n\n        case 'top':\n          _this.imagePosition['y'] = 0;\n          _this.imagePosition['height'] = imgOriginalWidthOrHeight;\n          break;\n\n        case 'bottom':\n          _this.imagePosition['y'] = canvasWidthOrHeight - imgOriginalWidthOrHeight;\n          _this.imagePosition['height'] = imgOriginalWidthOrHeight;\n          break;\n\n        case 'right':\n          _this.imagePosition['x'] = canvasWidthOrHeight - imgOriginalWidthOrHeight;\n          _this.imagePosition['width'] = imgOriginalWidthOrHeight;\n          break;\n\n        case 'left':\n          _this.imagePosition['x'] = 0;\n          _this.imagePosition['width'] = imgOriginalWidthOrHeight;\n          break;\n      }\n\n      if (_this.image.stretchMode) {\n        imageAlignIndex = axis === 'x' ? _this.image.stretchMode[0] : _this.image.stretchMode[1];\n\n        switch (imageAlignIndex) {\n          case 'none':\n            break;\n\n          case 'stretch':\n            _this.imagePosition[axis] = 0;\n            _this.imagePosition[axis === 'x' ? 'width' : 'height'] = canvasWidthOrHeight;\n            break;\n\n          case 'stretch-if-bigger':\n            if (imgOriginalWidthOrHeight < canvasWidthOrHeight) break;\n            _this.imagePosition[axis] = 0;\n            _this.imagePosition[axis === 'x' ? 'width' : 'height'] = canvasWidthOrHeight;\n            break;\n\n          case 'stretch-if-smaller':\n            if (imgOriginalWidthOrHeight > canvasWidthOrHeight) break;\n            _this.imagePosition[axis] = 0;\n            _this.imagePosition[axis === 'x' ? 'width' : 'height'] = canvasWidthOrHeight;\n            break;\n        }\n      }\n    }\n  }\n};","map":{"version":3,"sources":["/Users/sylv/Desktop/coding/portfolio-site/node_modules/granim/lib/prepareImage.js"],"names":["module","exports","_this","imagePosition","x","y","width","height","image","blendingMode","context","globalCompositeOperation","imageNode","setImagePosition","Image","onerror","Error","onload","imgOriginalWidth","imgOriginalHeight","refreshColorsAndPos","isPausedWhenNotInView","isCanvasInWindowView","animation","requestAnimationFrame","animateColors","bind","isImgLoaded","src","source","i","currentAxis","setImageAxisPosition","axis","canvasWidthOrHeight","imgOriginalWidthOrHeight","imageAlignIndex","position","imageAxisPosition","stretchMode"],"mappings":"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","sourcesContent":["'use strict';\r\n\r\nmodule.exports = function() {\r\n\tvar _this = this;\r\n\r\n\tif (!this.imagePosition) {\r\n\t\tthis.imagePosition = { x: 0, y: 0, width: 0, height: 0 };\r\n\t}\r\n\r\n\tif (this.image.blendingMode) {\r\n\t\tthis.context.globalCompositeOperation = this.image.blendingMode;\r\n\t}\r\n\r\n\tif (this.imageNode) {\r\n\t\tsetImagePosition();\r\n\t\treturn;\r\n\t}\r\n\r\n\tthis.imageNode = new Image();\r\n\tthis.imageNode.onerror = function() {\r\n\t\tthrow new Error('Granim: The image source is invalid.');\r\n\t};\r\n\tthis.imageNode.onload = function() {\r\n\t\t_this.imgOriginalWidth = _this.imageNode.width;\r\n\t\t_this.imgOriginalHeight = _this.imageNode.height;\r\n\t\tsetImagePosition();\r\n\t\t_this.refreshColorsAndPos();\r\n\t\tif (!_this.isPausedWhenNotInView || _this.isCanvasInWindowView) {\r\n\t\t\t_this.animation = requestAnimationFrame(_this.animateColors.bind(_this));\r\n\t\t}\r\n\t\t_this.isImgLoaded = true;\r\n\t};\r\n\tthis.imageNode.src = this.image.source;\r\n\r\n\tfunction setImagePosition() {\r\n\t\tvar i, currentAxis;\r\n\r\n\t\tfor (i = 0; i < 2; i++) {\r\n\t\t\tcurrentAxis = !i ? 'x' : 'y';\r\n\t\t\tsetImageAxisPosition(currentAxis);\r\n\t\t}\r\n\r\n\t\tfunction setImageAxisPosition(axis) {\r\n\t\t\tvar canvasWidthOrHeight = _this[axis + '1'];\r\n\t\t\tvar imgOriginalWidthOrHeight = _this[axis === 'x' ? 'imgOriginalWidth' : 'imgOriginalHeight'];\r\n\t\t\tvar imageAlignIndex = axis === 'x' ? _this.image.position[0] : _this.image.position[1];\r\n\t\t\tvar imageAxisPosition;\r\n\t\t\tswitch(imageAlignIndex) {\r\n\t\t\t\tcase 'center':\r\n\t\t\t\t\timageAxisPosition = imgOriginalWidthOrHeight > canvasWidthOrHeight\r\n\t\t\t\t\t\t? -(imgOriginalWidthOrHeight - canvasWidthOrHeight) / 2\r\n\t\t\t\t\t\t: (canvasWidthOrHeight - imgOriginalWidthOrHeight) / 2;\r\n\t\t\t\t\t_this.imagePosition[axis] = imageAxisPosition;\r\n\t\t\t\t\t_this.imagePosition[axis === 'x' ? 'width' : 'height'] = imgOriginalWidthOrHeight;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'top':\r\n\t\t\t\t\t_this.imagePosition['y'] = 0;\r\n\t\t\t\t\t_this.imagePosition['height'] = imgOriginalWidthOrHeight;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'bottom':\r\n\t\t\t\t\t_this.imagePosition['y'] = canvasWidthOrHeight - imgOriginalWidthOrHeight;\r\n\t\t\t\t\t_this.imagePosition['height'] = imgOriginalWidthOrHeight;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'right':\r\n\t\t\t\t\t_this.imagePosition['x'] = canvasWidthOrHeight - imgOriginalWidthOrHeight;\r\n\t\t\t\t\t_this.imagePosition['width'] = imgOriginalWidthOrHeight;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'left':\r\n\t\t\t\t\t_this.imagePosition['x'] = 0;\r\n\t\t\t\t\t_this.imagePosition['width'] = imgOriginalWidthOrHeight;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tif (_this.image.stretchMode) {\r\n\t\t\t\timageAlignIndex = axis === 'x' ? _this.image.stretchMode[0] : _this.image.stretchMode[1];\r\n\t\t\t\tswitch(imageAlignIndex) {\r\n\t\t\t\t\tcase 'none':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'stretch':\r\n\t\t\t\t\t\t_this.imagePosition[axis] = 0;\r\n\t\t\t\t\t\t_this.imagePosition[axis === 'x' ? 'width' : 'height'] = canvasWidthOrHeight;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'stretch-if-bigger':\r\n\t\t\t\t\t\tif (imgOriginalWidthOrHeight < canvasWidthOrHeight) break;\r\n\t\t\t\t\t\t_this.imagePosition[axis] = 0;\r\n\t\t\t\t\t\t_this.imagePosition[axis === 'x' ? 'width' : 'height'] = canvasWidthOrHeight;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'stretch-if-smaller':\r\n\t\t\t\t\t\tif (imgOriginalWidthOrHeight > canvasWidthOrHeight) break;\r\n\t\t\t\t\t\t_this.imagePosition[axis] = 0;\r\n\t\t\t\t\t\t_this.imagePosition[axis === 'x' ? 'width' : 'height'] = canvasWidthOrHeight;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\n"]},"metadata":{},"sourceType":"script"}